<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Geometric Sequence Calculator</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background-color: #f5f5f5;
        }
        .nav {
            background-color: #4CAF50;  /* 使用与按钮相同的绿色 */
            padding: 10px 20px;
            border-radius: 8px;
            margin-bottom: 20px;
            display: flex;
            gap: 20px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);  /* 添加柔和的阴影 */
        }
        .nav a {
            color: white;
            text-decoration: none;
            padding: 8px 16px;
            border-radius: 4px;
            transition: background-color 0.3s;
            opacity: 0.9;  /* 稍微降低不活跃链接的透明度 */
        }
        .nav a:hover {
            background-color: #45a049;  /* 使用与按钮hover相同的颜色 */
            opacity: 1;
        }
        .nav a.active {
            background-color: #45a049;
            font-weight: bold;
            opacity: 1;
        }
        .calculator {
            background-color: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .calc-group {
            margin: 20px 0;
        }
        input {
            padding: 8px;
            margin: 5px;
            border: 1px solid #ddd;
            border-radius: 4px;
            width: 100px;
        }
        .result-box {
            margin-top: 15px;
            padding: 10px;
            background-color: #f8f9fa;
            border-radius: 4px;
            border: 1px solid #ddd;
        }
        .sequence-box {
            height: 200px;
            overflow-y: auto;
            margin-top: 10px;
            padding: 10px;
            background-color: #f8f9fa;
            border-radius: 4px;
            border: 1px solid #ddd;
        }
        .sequence-item {
            margin: 5px 0;
            padding: 5px;
            border-bottom: 1px solid #eee;
        }
        .result {
            font-weight: bold;
            margin-top: 10px;
            word-wrap: break-word;
        }
        .faq {
            margin-top: 40px;
        }
        button {
            padding: 8px 16px;
            background-color: #4CAF50;
            color: white;
            border: none;
            border-radius: 4px;
            cursor: pointer;
            margin-top: 10px;
        }
        button:hover {
            background-color: #45a049;
        }
        .result-container > div {
            margin-bottom: 20px;
        }
        .tips {
            margin: 10px 0;
            padding: 10px;
            background-color: #e8f5e9;
            border-radius: 4px;
            color: #2e7d32;
            font-size: 0.9em;
        }
    </style>
</head>
<body>
    <nav class="nav">
        <a href="arithmetic.html">Arithmetic Sequence</a>
        <a href="geometric.html" class="active">Geometric Sequence</a>
    </nav>
    
    <div class="calculator">
        <h1>Geometric Sequence Calculator</h1>
        
        <div class="tips" style="display: none;">
            <strong>Tips:</strong> Use Tab to move to the next field. Use Shift+Tab to move to the previous field. Press Enter to calculate.
        </div>
        
        <div class="calc-group">
            <label>Calculate Geometric Sequence:</label><br>
            <input type="number" id="firstTerm" placeholder="First term a₁" step="any">
            <input type="number" id="ratio" placeholder="Common ratio r" step="any">
            <input type="number" id="terms" placeholder="Terms n" min="1">
            <button onclick="calculateSequence()">Calculate</button>
            
            <div class="result-container">
                <div>
                    <div class="result-box">
                        <strong>Sequence Sum:</strong>
                        <div class="result" id="sumResult">-</div>
                    </div>
                </div>
                <div>
                    <strong>First n Terms:</strong>
                    <div class="sequence-box" id="sequenceResult">
                        <!-- Sequence terms will be generated here -->
                    </div>
                </div>
            </div>
        </div>

        <div class="calc-group">
            <label>Calculate nth Term:</label><br>
            <input type="number" id="firstTerm2" placeholder="First term a₁" step="any">
            <input type="number" id="ratio2" placeholder="Common ratio r" step="any">
            <input type="number" id="nthTerm" placeholder="n" min="1">
            <button onclick="calculateNthTerm()">Calculate</button>
            
            <div class="result-box">
                <strong>Value of nth Term:</strong>
                <div class="result" id="nthTermResult">-</div>
            </div>
        </div>
    </div>

    <div class="faq">
        <h2>FAQ</h2>
        
        <h3>What is a Geometric Sequence?</h3>
        <p>A geometric sequence is a sequence where the ratio between each consecutive term is constant. This constant ratio is called the common ratio, usually denoted by the letter r.</p>

        <h3>How to Calculate the nth Term?</h3>
        <p>The formula for the nth term of a geometric sequence is: aₙ = a₁ × rⁿ⁻¹, where:<br>
           - aₙ is the nth term<br>
           - a₁ is the first term<br>
           - r is the common ratio<br>
           - n is the position number</p>

        <h3>How to Calculate the Sum?</h3>
        <p>The sum of the first n terms of a geometric sequence can be calculated using the formula:<br>
           - When r ≠ 1: Sₙ = a₁(1-rⁿ)/(1-r)<br>
           - When r = 1: Sₙ = n×a₁<br>
           where:<br>
           - Sₙ is the sum of n terms<br>
           - a₁ is the first term<br>
           - r is the common ratio<br>
           - n is the number of terms</p>
    </div>

    <script>
        function calculateSequence() {
            var a1 = parseFloat(document.getElementById('firstTerm').value);
            var q = parseFloat(document.getElementById('ratio').value);
            var n = parseInt(document.getElementById('terms').value);
            
            if (isNaN(a1) || isNaN(q) || isNaN(n) || n < 1) {
                alert('Please enter valid numbers!');
                return;
            }

            // 计算所有项
            var sequenceContainer = document.getElementById('sequenceResult');
            sequenceContainer.innerHTML = ''; // 清空现有内容
            
            for (var i = 0; i < n; i++) {
                var term = a1 * Math.pow(q, i);
                var termElement = document.createElement('div');
                termElement.className = 'sequence-item';
                // 对结果进行格式化：如果是整数则显示整数，如果是小数则保留4位
                var formattedTerm = Number.isInteger(term) ? term : parseFloat(term.toFixed(4));
                termElement.textContent = `a${i + 1} = ${formattedTerm}`;
                sequenceContainer.appendChild(termElement);
            }
            
            // 计算数列和
            var sum;
            if (Math.abs(q - 1) < 1e-10) { // q ≈ 1
                sum = n * a1;
            } else {
                sum = a1 * (1 - Math.pow(q, n)) / (1 - q);
            }
            document.getElementById('sumResult').textContent = Number.isInteger(sum) ? sum : parseFloat(sum.toFixed(4));
        }

        function calculateNthTerm() {
            var a1 = parseFloat(document.getElementById('firstTerm2').value);
            var q = parseFloat(document.getElementById('ratio2').value);
            var n = parseInt(document.getElementById('nthTerm').value);
            
            if (isNaN(a1) || isNaN(q) || isNaN(n) || n < 1) {
                alert('Please enter valid numbers!');
                return;
            }

            var nthTerm = a1 * Math.pow(q, n - 1);
            var formattedTerm = Number.isInteger(nthTerm) ? nthTerm : parseFloat(nthTerm.toFixed(4));
            document.getElementById('nthTermResult').textContent = formattedTerm;
        }

        // Add keyboard navigation
        function handleEnterKey(event, calculationType) {
            if (event.key === 'Enter') {
                if (calculationType === 'sequence') {
                    calculateSequence();
                } else if (calculationType === 'nthTerm') {
                    calculateNthTerm();
                }
            }
        }

        // Add event listeners for the first calculator
        document.getElementById('firstTerm').addEventListener('keypress', (e) => handleEnterKey(e, 'sequence'));
        document.getElementById('ratio').addEventListener('keypress', (e) => handleEnterKey(e, 'sequence'));
        document.getElementById('terms').addEventListener('keypress', (e) => handleEnterKey(e, 'sequence'));

        // Add event listeners for the second calculator
        document.getElementById('firstTerm2').addEventListener('keypress', (e) => handleEnterKey(e, 'nthTerm'));
        document.getElementById('ratio2').addEventListener('keypress', (e) => handleEnterKey(e, 'nthTerm'));
        document.getElementById('nthTerm').addEventListener('keypress', (e) => handleEnterKey(e, 'nthTerm'));
    </script>
</body>
</html> 
